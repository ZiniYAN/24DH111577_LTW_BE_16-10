@model _24DH111577_LTW_BE_16_10.Models.ViewModel.ProductDetailVM

@{
    ViewBag.Title = "ProductDetails";
    Layout = "~/Areas/Customer/Views/Shared/_CustomerLayout.cshtml";
}

<style>
    .product-details {
        max-width: 1200px;
        margin: 40px auto;
        padding: 0 20px;
    }

    .product-details__container {
        display: grid;
        grid-template-columns: 1fr 2fr 1fr;
        gap: 30px;
        background: #fff;
        border-radius: 12px;
        padding: 30px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    /* Image */
    .product-details__image {
        text-align: center;
    }

    .product-details__image img {
        max-width: 100%;
        max-height: 350px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        transition: transform 0.3s ease;
    }

    .product-details__image img:hover {
        transform: scale(1.05);
    }

    /* Info */
    .product-details__info {
        padding: 10px 20px;
    }

    .product-details__title {
        font-size: 28px;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 15px;
        line-height: 1.3;
    }

    .product-details__meta {
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid #e0e0e0;
    }

    .product-details__sold {
        color: #7f8c8d;
        font-size: 14px;
    }

    .product-details__price {
        font-size: 32px;
        font-weight: bold;
        color: #e74c3c;
    }

    .product-details__category {
        background: #ecf0f1;
        padding: 8px 16px;
        border-radius: 20px;
        font-size: 14px;
        color: #34495e;
        display: inline-block;
        margin-bottom: 20px;
    }

    .product-details__description-title {
        font-size: 18px;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 10px;
        padding-bottom: 8px;
        border-bottom: 2px solid #3498db;
    }

    .product-details__description {
        line-height: 1.8;
        color: #555;
        font-size: 15px;
    }

    /* Order */
    .product-details__order {
        background: #f8f9fa;
        padding: 25px;
        border-radius: 12px;
        border: 1px solid #e0e0e0;
    }

    .product-details__order-title {
        font-size: 16px;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 15px;
    }

    .product-details__quantity-group {
        margin-bottom: 20px;
    }

    .product-details__quantity-input {
        width: 100%;
        padding: 12px;
        border: 2px solid #ddd;
        border-radius: 6px;
        font-size: 16px;
        transition: border-color 0.3s ease;
    }

    .product-details__quantity-input:focus {
        outline: none;
        border-color: #3498db;
    }

    .product-details__estimate {
        background: #fff;
        padding: 15px;
        border-radius: 8px;
        text-align: center;
        margin-bottom: 20px;
        border: 2px dashed #3498db;
    }

    .product-details__estimate-label {
        font-size: 14px;
        color: #7f8c8d;
        margin-bottom: 5px;
    }

    .product-details__estimate-value {
        font-size: 24px;
        font-weight: bold;
        color: #e74c3c;
    }

    .product-details__add-to-cart {
        width: 100%;
        padding: 14px;
        background: #3498db;
        color: white;
        border: none;
        border-radius: 8px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .product-details__add-to-cart:hover {
        background: #2980b9;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(52, 152, 219, 0.4);
    }

    .product-details__add-to-cart:active {
        transform: translateY(0);
    }

    /* Related Products Section */
    .product-details__related {
        margin-top: 50px;
    }

</style>

<div class="product-details">
    <div class="product-details__container">
        <!-- Image Section -->
        <div class="product-details__image">
            <img src="@Model.product.ProductImage" alt="@Model.product.ProductName" />
        </div>

        <!-- Info Section -->
        <div class="product-details__info">
            <h1 class="product-details__title">@Model.product.ProductName</h1>

            <div class="product-details__meta">
                <span class="product-details__sold">Đã bán: @Model.product.OrderDetails.Count</span>
            </div>

            <div class="product-details__price">
                @Model.product.ProductPrice.ToString("C", new System.Globalization.CultureInfo("vi-VN"))
            </div>

            <div style="margin: 20px 0;">
                <span class="product-details__category">
                     @Model.product.Category.CategoryName
                </span>
            </div>

            <h2 class="product-details__description-title">Mô tả sản phẩm</h2>
            <p class="product-details__description">
                @Model.product.ProductDescription
            </p>
        </div>

        <!-- Order Section -->
        <div class="product-details__order">
            @using (Html.BeginForm("AddToCart", "Cart", FormMethod.Post))
            {
                @Html.Hidden("id", Model.product.ProductID)

                <div class="product-details__quantity-group">
                    <label class="product-details__order-title">Số lượng</label>
                    <input type="number"
                           id="quantityInput"
                           name="quantity"
                           value="@Model.quantity"
                           min="1"
                           max="999"
                           class="product-details__quantity-input"
                           onchange="updateEstimate()"
                           oninput="updateEstimate()" />
                </div>

                <div class="product-details__estimate">
                    <div class="product-details__estimate-label">Tạm tính</div>
                    <div class="product-details__estimate-value">
                        <span id="estimateDisplay">@Model.estimatedValue.ToString("N0")</span> ₫
                    </div>
                </div>

                <button type="submit" class="product-details__add-to-cart">
                    <i class="fa-solid fa-cart-plus"></i> Thêm vào giỏ hàng
                </button>
            }
        </div>
    </div>

    <!-- Related Products -->
    <div class="product-details__related">
        @Html.Partial("PVRelatedProduct", Model)
    </div>

    <!-- Top Products -->
    <div class="product-details__related">
        @Html.Partial("PVTopProduct", Model)
    </div>
</div>

<script>
    function updateEstimate() {
        var quantity = parseInt(document.getElementById('quantityInput').value) || 1;
        var unitPrice = @Model.product.ProductPrice;
        var estimate = quantity * unitPrice;
        document.getElementById('estimateDisplay').innerText = estimate.toLocaleString('vi-VN');
    }
</script>